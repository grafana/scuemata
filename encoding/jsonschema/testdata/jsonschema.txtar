-- in.cue --
package generate

import "github.com/grafana/thema"

thema.#Lineage
name: "oneref"
seqs: [
    {
        schemas: [
            {
                foo: string
                Bar: int32
                baz: #Baz

                #Baz: {
                    run: string
                    tell: bytes
                    dat: int32
                    say: #Foo
                }

                #Foo: {
                    one: string
                }
            }
        ]
    }
]
-- out/generate/0.0/output --
"Baz": {
	"type": "object"
	"required": ["run", "tell", "dat", "say"]
	"properties": {
		"run": {
			"type": "string"
		}
		"tell": {
			"type":   "string"
			"format": "binary"
		}
		"dat": {
			"type":   "integer"
			"format": "int32"
		}
		"say": {
			"$ref": "#/Foo"
		}
	}
	"$schema": "http://json-schema.org/draft-04/schema#"
}
"Foo": {
	"type": "object"
	"required": ["one"]
	"properties": {
		"one": {
			"type": "string"
		}
	}
	"$schema": "http://json-schema.org/draft-04/schema#"
}
"oneref": {
	"type": "object"
	"required": ["foo", "Bar", "baz"]
	"properties": {
		"foo": {
			"type": "string"
		}
		"Bar": {
			"type":   "integer"
			"format": "int32"
		}
		"baz": {
			"$ref": "#/Baz"
		}
	}
	"$schema": "http://json-schema.org/draft-04/schema#"
}

